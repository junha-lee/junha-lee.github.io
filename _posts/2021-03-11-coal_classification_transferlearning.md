```python
import os
train_dir = './input/dataset3/train'
validation_dir ='./input/dataset3/test'

train_1_dir = os.path.join(train_dir, '연갈탄')

train_2_dir = os.path.join(train_dir, '유연탄')

validation_1_dir = os.path.join(validation_dir, '연갈탄')

validation_2_dir = os.path.join(validation_dir, '유연탄')
```


```python
train_1_fnames = os.listdir(train_1_dir)
print(train_1_fnames[:100])

train_2_fnames = os.listdir(train_2_dir)
train_2_fnames.sort()
print(train_2_fnames[:100])
```

    ['0.jpg', '1.jpg', '11.jpg', '12.jpg', '14.jpg', '15.jpg', '17.jpg', '18.jpg', '20.jpg', '21.jpg', '22.jpg', '23.jpg', '24.jpg', '26.jpg', '27.jpg', '3.jpg', '5.jpg', '6.jpg', '7.jpg', '9.jpg', '_0_1000.png', '_0_1017.png', '_0_1026.png', '_0_1034.png', '_0_1061.png', '_0_1065.png', '_0_1136.png', '_0_1159.png', '_0_118.png', '_0_1195.png', '_0_1199.png', '_0_1224.png', '_0_1245.png', '_0_1283.png', '_0_1285.png', '_0_1309.png', '_0_1329.png', '_0_1341.png', '_0_1351.png', '_0_1362.png', '_0_1413.png', '_0_1421.png', '_0_1449.png', '_0_145.png', '_0_1460.png', '_0_1473.png', '_0_1501.png', '_0_1510.png', '_0_1522.png', '_0_1528.png', '_0_1529.png', '_0_156.png', '_0_1594.png', '_0_1655.png', '_0_1670.png', '_0_1674.png', '_0_1701.png', '_0_1712.png', '_0_1721.png', '_0_1734.png', '_0_1781.png', '_0_1805.png', '_0_181.png', '_0_1824.png', '_0_1830.png', '_0_1859.png', '_0_1903.png', '_0_1960.png', '_0_2010.png', '_0_2042.png', '_0_205.png', '_0_2052.png', '_0_2071.png', '_0_2084.png', '_0_2134.png', '_0_2137.png', '_0_2151.png', '_0_2170.png', '_0_221.png', '_0_2246.png', '_0_2274.png', '_0_2279.png', '_0_2293.png', '_0_2303.png', '_0_2312.png', '_0_2316.png', '_0_2325.png', '_0_2341.png', '_0_2359.png', '_0_2367.png', '_0_2375.png', '_0_2385.png', '_0_2400.png', '_0_2412.png', '_0_2415.png', '_0_2429.png', '_0_2515.png', '_0_2589.png', '_0_2590.png', '_0_2634.png']
    ['10.png', '100.png', '101.png', '102.png', '104.png', '105.png', '107.png', '108.png', '109.png', '110.png', '112.png', '113.png', '114.png', '116.png', '117.png', '118.png', '120.png', '122.png', '123.png', '124.png', '129.png', '13.png', '131.png', '133.png', '134.png', '135.png', '136.png', '14.png', '140.png', '142.png', '145.png', '146.png', '147.png', '148.png', '149.png', '155.png', '157.png', '158.png', '159.png', '16.png', '167.png', '168.png', '17.png', '170.png', '172.png', '173.png', '174.png', '176.png', '178.png', '179.png', '18.png', '182.png', '184.png', '185.png', '188.png', '191.png', '192.png', '193.png', '194.png', '196.png', '2.png', '20.png', '22.png', '23.png', '24.png', '28.png', '29.png', '3.png', '30.png', '31.png', '33.png', '4.png', '40.png', '41.png', '44.png', '45.png', '46.png', '47.png', '5.png', '52.png', '53.png', '54.png', '55.png', '56.png', '57.png', '59.png', '6.png', '60.png', '61.png', '62.png', '64.png', '65.png', '66.png', '67.png', '68.png', '69.png', '7.png', '70.png', '73.png', '75.png']
    


```python
%matplotlib inline
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
nrows = 4
ncols = 4
pic_index = 0
```


```python
fig = plt.gcf()
fig.set_size_inches(ncols * 4, nrows * 4)

pic_index += 8
next_1_pix = [os.path.join(train_1_dir, fname) 
                for fname in train_1_fnames[pic_index-8:pic_index]]
next_2_pix = [os.path.join(train_2_dir, fname) 
                for fname in train_2_fnames[pic_index-8:pic_index]]

for i, img_path in enumerate(next_1_pix+next_2_pix):
  # Set up subplot; subplot indices start at 1
  sp = plt.subplot(nrows, ncols, i + 1)
  sp.axis('Off') # Don't show axes (or gridlines)
  img = mpimg.imread(img_path)
  plt.imshow(img)
plt.show()
```


    
![coal_classification_transferlearning](https://raw.githubusercontent.com/junha-lee/junha-lee.github.io/main/assets/images/coal_classification_transferlearning_files/coal_classification_transferlearning_3_0.png)
    



```python
from tensorflow.keras import layers
from tensorflow.keras import Model
import numpy as np
import tensorflow as tf
from tensorflow import keras
from keras import models
```


```python
base_model = keras.applications.ResNet152(
    weights='imagenet',  # Load weights pre-trained on ImageNet.
    input_shape=(150, 150, 3),
    include_top=False)  # Do not include the ImageNet classifier at the top.
```

    Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/resnet/resnet152_weights_tf_dim_ordering_tf_kernels_notop.h5
    234700800/234698864 [==============================] - 30s 0us/step
    


```python
base_model.trainable = False
base_model.summary()
```

    Model: "resnet152"
    __________________________________________________________________________________________________
    Layer (type)                    Output Shape         Param #     Connected to                     
    ==================================================================================================
    input_3 (InputLayer)            [(None, 150, 150, 3) 0                                            
    __________________________________________________________________________________________________
    conv1_pad (ZeroPadding2D)       (None, 156, 156, 3)  0           input_3[0][0]                    
    __________________________________________________________________________________________________
    conv1_conv (Conv2D)             (None, 75, 75, 64)   9472        conv1_pad[0][0]                  
    __________________________________________________________________________________________________
    conv1_bn (BatchNormalization)   (None, 75, 75, 64)   256         conv1_conv[0][0]                 
    __________________________________________________________________________________________________
    conv1_relu (Activation)         (None, 75, 75, 64)   0           conv1_bn[0][0]                   
    __________________________________________________________________________________________________
    pool1_pad (ZeroPadding2D)       (None, 77, 77, 64)   0           conv1_relu[0][0]                 
    __________________________________________________________________________________________________
    pool1_pool (MaxPooling2D)       (None, 38, 38, 64)   0           pool1_pad[0][0]                  
    __________________________________________________________________________________________________
    conv2_block1_1_conv (Conv2D)    (None, 38, 38, 64)   4160        pool1_pool[0][0]                 
    __________________________________________________________________________________________________
    conv2_block1_1_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block1_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_1_relu (Activation (None, 38, 38, 64)   0           conv2_block1_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block1_2_conv (Conv2D)    (None, 38, 38, 64)   36928       conv2_block1_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_2_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block1_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_2_relu (Activation (None, 38, 38, 64)   0           conv2_block1_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block1_0_conv (Conv2D)    (None, 38, 38, 256)  16640       pool1_pool[0][0]                 
    __________________________________________________________________________________________________
    conv2_block1_3_conv (Conv2D)    (None, 38, 38, 256)  16640       conv2_block1_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_0_bn (BatchNormali (None, 38, 38, 256)  1024        conv2_block1_0_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_3_bn (BatchNormali (None, 38, 38, 256)  1024        conv2_block1_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block1_add (Add)          (None, 38, 38, 256)  0           conv2_block1_0_bn[0][0]          
                                                                     conv2_block1_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block1_out (Activation)   (None, 38, 38, 256)  0           conv2_block1_add[0][0]           
    __________________________________________________________________________________________________
    conv2_block2_1_conv (Conv2D)    (None, 38, 38, 64)   16448       conv2_block1_out[0][0]           
    __________________________________________________________________________________________________
    conv2_block2_1_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block2_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block2_1_relu (Activation (None, 38, 38, 64)   0           conv2_block2_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block2_2_conv (Conv2D)    (None, 38, 38, 64)   36928       conv2_block2_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block2_2_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block2_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block2_2_relu (Activation (None, 38, 38, 64)   0           conv2_block2_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block2_3_conv (Conv2D)    (None, 38, 38, 256)  16640       conv2_block2_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block2_3_bn (BatchNormali (None, 38, 38, 256)  1024        conv2_block2_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block2_add (Add)          (None, 38, 38, 256)  0           conv2_block1_out[0][0]           
                                                                     conv2_block2_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block2_out (Activation)   (None, 38, 38, 256)  0           conv2_block2_add[0][0]           
    __________________________________________________________________________________________________
    conv2_block3_1_conv (Conv2D)    (None, 38, 38, 64)   16448       conv2_block2_out[0][0]           
    __________________________________________________________________________________________________
    conv2_block3_1_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block3_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block3_1_relu (Activation (None, 38, 38, 64)   0           conv2_block3_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block3_2_conv (Conv2D)    (None, 38, 38, 64)   36928       conv2_block3_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block3_2_bn (BatchNormali (None, 38, 38, 64)   256         conv2_block3_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block3_2_relu (Activation (None, 38, 38, 64)   0           conv2_block3_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block3_3_conv (Conv2D)    (None, 38, 38, 256)  16640       conv2_block3_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv2_block3_3_bn (BatchNormali (None, 38, 38, 256)  1024        conv2_block3_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv2_block3_add (Add)          (None, 38, 38, 256)  0           conv2_block2_out[0][0]           
                                                                     conv2_block3_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv2_block3_out (Activation)   (None, 38, 38, 256)  0           conv2_block3_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block1_1_conv (Conv2D)    (None, 19, 19, 128)  32896       conv2_block3_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block1_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block1_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_1_relu (Activation (None, 19, 19, 128)  0           conv3_block1_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block1_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block1_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block1_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_2_relu (Activation (None, 19, 19, 128)  0           conv3_block1_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block1_0_conv (Conv2D)    (None, 19, 19, 512)  131584      conv2_block3_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block1_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block1_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_0_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block1_0_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block1_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block1_add (Add)          (None, 19, 19, 512)  0           conv3_block1_0_bn[0][0]          
                                                                     conv3_block1_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block1_out (Activation)   (None, 19, 19, 512)  0           conv3_block1_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block2_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block1_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block2_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block2_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block2_1_relu (Activation (None, 19, 19, 128)  0           conv3_block2_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block2_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block2_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block2_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block2_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block2_2_relu (Activation (None, 19, 19, 128)  0           conv3_block2_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block2_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block2_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block2_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block2_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block2_add (Add)          (None, 19, 19, 512)  0           conv3_block1_out[0][0]           
                                                                     conv3_block2_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block2_out (Activation)   (None, 19, 19, 512)  0           conv3_block2_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block3_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block2_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block3_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block3_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block3_1_relu (Activation (None, 19, 19, 128)  0           conv3_block3_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block3_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block3_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block3_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block3_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block3_2_relu (Activation (None, 19, 19, 128)  0           conv3_block3_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block3_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block3_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block3_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block3_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block3_add (Add)          (None, 19, 19, 512)  0           conv3_block2_out[0][0]           
                                                                     conv3_block3_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block3_out (Activation)   (None, 19, 19, 512)  0           conv3_block3_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block4_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block3_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block4_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block4_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block4_1_relu (Activation (None, 19, 19, 128)  0           conv3_block4_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block4_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block4_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block4_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block4_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block4_2_relu (Activation (None, 19, 19, 128)  0           conv3_block4_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block4_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block4_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block4_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block4_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block4_add (Add)          (None, 19, 19, 512)  0           conv3_block3_out[0][0]           
                                                                     conv3_block4_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block4_out (Activation)   (None, 19, 19, 512)  0           conv3_block4_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block5_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block4_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block5_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block5_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block5_1_relu (Activation (None, 19, 19, 128)  0           conv3_block5_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block5_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block5_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block5_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block5_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block5_2_relu (Activation (None, 19, 19, 128)  0           conv3_block5_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block5_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block5_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block5_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block5_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block5_add (Add)          (None, 19, 19, 512)  0           conv3_block4_out[0][0]           
                                                                     conv3_block5_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block5_out (Activation)   (None, 19, 19, 512)  0           conv3_block5_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block6_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block5_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block6_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block6_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block6_1_relu (Activation (None, 19, 19, 128)  0           conv3_block6_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block6_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block6_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block6_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block6_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block6_2_relu (Activation (None, 19, 19, 128)  0           conv3_block6_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block6_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block6_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block6_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block6_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block6_add (Add)          (None, 19, 19, 512)  0           conv3_block5_out[0][0]           
                                                                     conv3_block6_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block6_out (Activation)   (None, 19, 19, 512)  0           conv3_block6_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block7_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block6_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block7_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block7_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block7_1_relu (Activation (None, 19, 19, 128)  0           conv3_block7_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block7_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block7_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block7_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block7_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block7_2_relu (Activation (None, 19, 19, 128)  0           conv3_block7_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block7_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block7_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block7_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block7_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block7_add (Add)          (None, 19, 19, 512)  0           conv3_block6_out[0][0]           
                                                                     conv3_block7_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block7_out (Activation)   (None, 19, 19, 512)  0           conv3_block7_add[0][0]           
    __________________________________________________________________________________________________
    conv3_block8_1_conv (Conv2D)    (None, 19, 19, 128)  65664       conv3_block7_out[0][0]           
    __________________________________________________________________________________________________
    conv3_block8_1_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block8_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block8_1_relu (Activation (None, 19, 19, 128)  0           conv3_block8_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block8_2_conv (Conv2D)    (None, 19, 19, 128)  147584      conv3_block8_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block8_2_bn (BatchNormali (None, 19, 19, 128)  512         conv3_block8_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block8_2_relu (Activation (None, 19, 19, 128)  0           conv3_block8_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block8_3_conv (Conv2D)    (None, 19, 19, 512)  66048       conv3_block8_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv3_block8_3_bn (BatchNormali (None, 19, 19, 512)  2048        conv3_block8_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv3_block8_add (Add)          (None, 19, 19, 512)  0           conv3_block7_out[0][0]           
                                                                     conv3_block8_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv3_block8_out (Activation)   (None, 19, 19, 512)  0           conv3_block8_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block1_1_conv (Conv2D)    (None, 10, 10, 256)  131328      conv3_block8_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block1_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block1_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_1_relu (Activation (None, 10, 10, 256)  0           conv4_block1_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block1_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block1_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block1_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_2_relu (Activation (None, 10, 10, 256)  0           conv4_block1_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block1_0_conv (Conv2D)    (None, 10, 10, 1024) 525312      conv3_block8_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block1_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block1_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_0_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block1_0_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block1_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block1_add (Add)          (None, 10, 10, 1024) 0           conv4_block1_0_bn[0][0]          
                                                                     conv4_block1_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block1_out (Activation)   (None, 10, 10, 1024) 0           conv4_block1_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block2_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block1_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block2_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block2_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block2_1_relu (Activation (None, 10, 10, 256)  0           conv4_block2_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block2_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block2_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block2_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block2_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block2_2_relu (Activation (None, 10, 10, 256)  0           conv4_block2_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block2_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block2_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block2_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block2_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block2_add (Add)          (None, 10, 10, 1024) 0           conv4_block1_out[0][0]           
                                                                     conv4_block2_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block2_out (Activation)   (None, 10, 10, 1024) 0           conv4_block2_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block3_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block2_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block3_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block3_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block3_1_relu (Activation (None, 10, 10, 256)  0           conv4_block3_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block3_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block3_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block3_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block3_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block3_2_relu (Activation (None, 10, 10, 256)  0           conv4_block3_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block3_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block3_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block3_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block3_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block3_add (Add)          (None, 10, 10, 1024) 0           conv4_block2_out[0][0]           
                                                                     conv4_block3_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block3_out (Activation)   (None, 10, 10, 1024) 0           conv4_block3_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block4_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block3_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block4_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block4_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block4_1_relu (Activation (None, 10, 10, 256)  0           conv4_block4_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block4_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block4_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block4_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block4_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block4_2_relu (Activation (None, 10, 10, 256)  0           conv4_block4_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block4_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block4_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block4_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block4_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block4_add (Add)          (None, 10, 10, 1024) 0           conv4_block3_out[0][0]           
                                                                     conv4_block4_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block4_out (Activation)   (None, 10, 10, 1024) 0           conv4_block4_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block5_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block4_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block5_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block5_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block5_1_relu (Activation (None, 10, 10, 256)  0           conv4_block5_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block5_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block5_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block5_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block5_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block5_2_relu (Activation (None, 10, 10, 256)  0           conv4_block5_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block5_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block5_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block5_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block5_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block5_add (Add)          (None, 10, 10, 1024) 0           conv4_block4_out[0][0]           
                                                                     conv4_block5_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block5_out (Activation)   (None, 10, 10, 1024) 0           conv4_block5_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block6_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block5_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block6_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block6_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block6_1_relu (Activation (None, 10, 10, 256)  0           conv4_block6_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block6_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block6_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block6_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block6_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block6_2_relu (Activation (None, 10, 10, 256)  0           conv4_block6_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block6_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block6_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block6_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block6_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block6_add (Add)          (None, 10, 10, 1024) 0           conv4_block5_out[0][0]           
                                                                     conv4_block6_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block6_out (Activation)   (None, 10, 10, 1024) 0           conv4_block6_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block7_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block6_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block7_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block7_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block7_1_relu (Activation (None, 10, 10, 256)  0           conv4_block7_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block7_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block7_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block7_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block7_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block7_2_relu (Activation (None, 10, 10, 256)  0           conv4_block7_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block7_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block7_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block7_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block7_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block7_add (Add)          (None, 10, 10, 1024) 0           conv4_block6_out[0][0]           
                                                                     conv4_block7_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block7_out (Activation)   (None, 10, 10, 1024) 0           conv4_block7_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block8_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block7_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block8_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block8_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block8_1_relu (Activation (None, 10, 10, 256)  0           conv4_block8_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block8_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block8_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block8_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block8_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block8_2_relu (Activation (None, 10, 10, 256)  0           conv4_block8_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block8_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block8_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block8_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block8_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block8_add (Add)          (None, 10, 10, 1024) 0           conv4_block7_out[0][0]           
                                                                     conv4_block8_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block8_out (Activation)   (None, 10, 10, 1024) 0           conv4_block8_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block9_1_conv (Conv2D)    (None, 10, 10, 256)  262400      conv4_block8_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block9_1_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block9_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block9_1_relu (Activation (None, 10, 10, 256)  0           conv4_block9_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block9_2_conv (Conv2D)    (None, 10, 10, 256)  590080      conv4_block9_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block9_2_bn (BatchNormali (None, 10, 10, 256)  1024        conv4_block9_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block9_2_relu (Activation (None, 10, 10, 256)  0           conv4_block9_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block9_3_conv (Conv2D)    (None, 10, 10, 1024) 263168      conv4_block9_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv4_block9_3_bn (BatchNormali (None, 10, 10, 1024) 4096        conv4_block9_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv4_block9_add (Add)          (None, 10, 10, 1024) 0           conv4_block8_out[0][0]           
                                                                     conv4_block9_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv4_block9_out (Activation)   (None, 10, 10, 1024) 0           conv4_block9_add[0][0]           
    __________________________________________________________________________________________________
    conv4_block10_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block9_out[0][0]           
    __________________________________________________________________________________________________
    conv4_block10_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block10_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block10_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block10_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block10_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block10_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block10_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block10_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block10_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block10_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block10_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block10_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block10_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block10_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block10_add (Add)         (None, 10, 10, 1024) 0           conv4_block9_out[0][0]           
                                                                     conv4_block10_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block10_out (Activation)  (None, 10, 10, 1024) 0           conv4_block10_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block11_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block10_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block11_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block11_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block11_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block11_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block11_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block11_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block11_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block11_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block11_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block11_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block11_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block11_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block11_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block11_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block11_add (Add)         (None, 10, 10, 1024) 0           conv4_block10_out[0][0]          
                                                                     conv4_block11_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block11_out (Activation)  (None, 10, 10, 1024) 0           conv4_block11_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block12_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block11_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block12_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block12_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block12_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block12_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block12_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block12_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block12_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block12_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block12_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block12_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block12_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block12_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block12_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block12_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block12_add (Add)         (None, 10, 10, 1024) 0           conv4_block11_out[0][0]          
                                                                     conv4_block12_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block12_out (Activation)  (None, 10, 10, 1024) 0           conv4_block12_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block13_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block12_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block13_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block13_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block13_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block13_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block13_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block13_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block13_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block13_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block13_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block13_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block13_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block13_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block13_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block13_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block13_add (Add)         (None, 10, 10, 1024) 0           conv4_block12_out[0][0]          
                                                                     conv4_block13_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block13_out (Activation)  (None, 10, 10, 1024) 0           conv4_block13_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block14_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block13_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block14_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block14_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block14_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block14_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block14_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block14_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block14_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block14_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block14_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block14_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block14_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block14_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block14_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block14_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block14_add (Add)         (None, 10, 10, 1024) 0           conv4_block13_out[0][0]          
                                                                     conv4_block14_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block14_out (Activation)  (None, 10, 10, 1024) 0           conv4_block14_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block15_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block14_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block15_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block15_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block15_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block15_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block15_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block15_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block15_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block15_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block15_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block15_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block15_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block15_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block15_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block15_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block15_add (Add)         (None, 10, 10, 1024) 0           conv4_block14_out[0][0]          
                                                                     conv4_block15_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block15_out (Activation)  (None, 10, 10, 1024) 0           conv4_block15_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block16_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block15_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block16_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block16_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block16_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block16_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block16_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block16_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block16_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block16_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block16_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block16_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block16_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block16_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block16_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block16_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block16_add (Add)         (None, 10, 10, 1024) 0           conv4_block15_out[0][0]          
                                                                     conv4_block16_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block16_out (Activation)  (None, 10, 10, 1024) 0           conv4_block16_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block17_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block16_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block17_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block17_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block17_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block17_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block17_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block17_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block17_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block17_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block17_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block17_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block17_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block17_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block17_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block17_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block17_add (Add)         (None, 10, 10, 1024) 0           conv4_block16_out[0][0]          
                                                                     conv4_block17_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block17_out (Activation)  (None, 10, 10, 1024) 0           conv4_block17_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block18_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block17_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block18_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block18_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block18_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block18_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block18_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block18_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block18_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block18_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block18_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block18_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block18_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block18_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block18_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block18_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block18_add (Add)         (None, 10, 10, 1024) 0           conv4_block17_out[0][0]          
                                                                     conv4_block18_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block18_out (Activation)  (None, 10, 10, 1024) 0           conv4_block18_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block19_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block18_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block19_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block19_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block19_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block19_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block19_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block19_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block19_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block19_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block19_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block19_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block19_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block19_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block19_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block19_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block19_add (Add)         (None, 10, 10, 1024) 0           conv4_block18_out[0][0]          
                                                                     conv4_block19_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block19_out (Activation)  (None, 10, 10, 1024) 0           conv4_block19_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block20_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block19_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block20_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block20_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block20_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block20_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block20_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block20_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block20_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block20_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block20_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block20_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block20_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block20_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block20_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block20_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block20_add (Add)         (None, 10, 10, 1024) 0           conv4_block19_out[0][0]          
                                                                     conv4_block20_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block20_out (Activation)  (None, 10, 10, 1024) 0           conv4_block20_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block21_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block20_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block21_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block21_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block21_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block21_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block21_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block21_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block21_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block21_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block21_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block21_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block21_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block21_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block21_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block21_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block21_add (Add)         (None, 10, 10, 1024) 0           conv4_block20_out[0][0]          
                                                                     conv4_block21_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block21_out (Activation)  (None, 10, 10, 1024) 0           conv4_block21_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block22_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block21_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block22_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block22_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block22_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block22_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block22_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block22_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block22_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block22_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block22_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block22_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block22_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block22_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block22_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block22_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block22_add (Add)         (None, 10, 10, 1024) 0           conv4_block21_out[0][0]          
                                                                     conv4_block22_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block22_out (Activation)  (None, 10, 10, 1024) 0           conv4_block22_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block23_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block22_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block23_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block23_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block23_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block23_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block23_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block23_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block23_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block23_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block23_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block23_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block23_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block23_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block23_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block23_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block23_add (Add)         (None, 10, 10, 1024) 0           conv4_block22_out[0][0]          
                                                                     conv4_block23_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block23_out (Activation)  (None, 10, 10, 1024) 0           conv4_block23_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block24_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block23_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block24_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block24_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block24_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block24_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block24_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block24_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block24_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block24_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block24_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block24_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block24_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block24_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block24_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block24_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block24_add (Add)         (None, 10, 10, 1024) 0           conv4_block23_out[0][0]          
                                                                     conv4_block24_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block24_out (Activation)  (None, 10, 10, 1024) 0           conv4_block24_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block25_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block24_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block25_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block25_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block25_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block25_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block25_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block25_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block25_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block25_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block25_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block25_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block25_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block25_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block25_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block25_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block25_add (Add)         (None, 10, 10, 1024) 0           conv4_block24_out[0][0]          
                                                                     conv4_block25_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block25_out (Activation)  (None, 10, 10, 1024) 0           conv4_block25_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block26_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block25_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block26_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block26_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block26_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block26_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block26_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block26_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block26_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block26_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block26_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block26_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block26_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block26_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block26_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block26_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block26_add (Add)         (None, 10, 10, 1024) 0           conv4_block25_out[0][0]          
                                                                     conv4_block26_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block26_out (Activation)  (None, 10, 10, 1024) 0           conv4_block26_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block27_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block26_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block27_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block27_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block27_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block27_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block27_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block27_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block27_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block27_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block27_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block27_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block27_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block27_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block27_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block27_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block27_add (Add)         (None, 10, 10, 1024) 0           conv4_block26_out[0][0]          
                                                                     conv4_block27_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block27_out (Activation)  (None, 10, 10, 1024) 0           conv4_block27_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block28_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block27_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block28_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block28_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block28_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block28_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block28_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block28_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block28_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block28_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block28_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block28_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block28_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block28_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block28_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block28_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block28_add (Add)         (None, 10, 10, 1024) 0           conv4_block27_out[0][0]          
                                                                     conv4_block28_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block28_out (Activation)  (None, 10, 10, 1024) 0           conv4_block28_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block29_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block28_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block29_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block29_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block29_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block29_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block29_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block29_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block29_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block29_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block29_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block29_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block29_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block29_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block29_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block29_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block29_add (Add)         (None, 10, 10, 1024) 0           conv4_block28_out[0][0]          
                                                                     conv4_block29_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block29_out (Activation)  (None, 10, 10, 1024) 0           conv4_block29_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block30_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block29_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block30_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block30_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block30_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block30_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block30_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block30_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block30_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block30_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block30_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block30_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block30_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block30_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block30_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block30_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block30_add (Add)         (None, 10, 10, 1024) 0           conv4_block29_out[0][0]          
                                                                     conv4_block30_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block30_out (Activation)  (None, 10, 10, 1024) 0           conv4_block30_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block31_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block30_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block31_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block31_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block31_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block31_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block31_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block31_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block31_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block31_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block31_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block31_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block31_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block31_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block31_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block31_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block31_add (Add)         (None, 10, 10, 1024) 0           conv4_block30_out[0][0]          
                                                                     conv4_block31_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block31_out (Activation)  (None, 10, 10, 1024) 0           conv4_block31_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block32_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block31_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block32_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block32_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block32_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block32_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block32_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block32_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block32_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block32_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block32_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block32_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block32_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block32_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block32_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block32_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block32_add (Add)         (None, 10, 10, 1024) 0           conv4_block31_out[0][0]          
                                                                     conv4_block32_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block32_out (Activation)  (None, 10, 10, 1024) 0           conv4_block32_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block33_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block32_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block33_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block33_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block33_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block33_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block33_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block33_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block33_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block33_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block33_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block33_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block33_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block33_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block33_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block33_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block33_add (Add)         (None, 10, 10, 1024) 0           conv4_block32_out[0][0]          
                                                                     conv4_block33_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block33_out (Activation)  (None, 10, 10, 1024) 0           conv4_block33_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block34_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block33_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block34_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block34_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block34_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block34_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block34_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block34_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block34_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block34_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block34_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block34_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block34_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block34_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block34_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block34_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block34_add (Add)         (None, 10, 10, 1024) 0           conv4_block33_out[0][0]          
                                                                     conv4_block34_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block34_out (Activation)  (None, 10, 10, 1024) 0           conv4_block34_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block35_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block34_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block35_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block35_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block35_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block35_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block35_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block35_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block35_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block35_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block35_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block35_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block35_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block35_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block35_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block35_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block35_add (Add)         (None, 10, 10, 1024) 0           conv4_block34_out[0][0]          
                                                                     conv4_block35_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block35_out (Activation)  (None, 10, 10, 1024) 0           conv4_block35_add[0][0]          
    __________________________________________________________________________________________________
    conv4_block36_1_conv (Conv2D)   (None, 10, 10, 256)  262400      conv4_block35_out[0][0]          
    __________________________________________________________________________________________________
    conv4_block36_1_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block36_1_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block36_1_relu (Activatio (None, 10, 10, 256)  0           conv4_block36_1_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block36_2_conv (Conv2D)   (None, 10, 10, 256)  590080      conv4_block36_1_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block36_2_bn (BatchNormal (None, 10, 10, 256)  1024        conv4_block36_2_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block36_2_relu (Activatio (None, 10, 10, 256)  0           conv4_block36_2_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block36_3_conv (Conv2D)   (None, 10, 10, 1024) 263168      conv4_block36_2_relu[0][0]       
    __________________________________________________________________________________________________
    conv4_block36_3_bn (BatchNormal (None, 10, 10, 1024) 4096        conv4_block36_3_conv[0][0]       
    __________________________________________________________________________________________________
    conv4_block36_add (Add)         (None, 10, 10, 1024) 0           conv4_block35_out[0][0]          
                                                                     conv4_block36_3_bn[0][0]         
    __________________________________________________________________________________________________
    conv4_block36_out (Activation)  (None, 10, 10, 1024) 0           conv4_block36_add[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_1_conv (Conv2D)    (None, 5, 5, 512)    524800      conv4_block36_out[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_1_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block1_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_1_relu (Activation (None, 5, 5, 512)    0           conv5_block1_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_2_conv (Conv2D)    (None, 5, 5, 512)    2359808     conv5_block1_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_2_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block1_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_2_relu (Activation (None, 5, 5, 512)    0           conv5_block1_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_0_conv (Conv2D)    (None, 5, 5, 2048)   2099200     conv4_block36_out[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_3_conv (Conv2D)    (None, 5, 5, 2048)   1050624     conv5_block1_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_0_bn (BatchNormali (None, 5, 5, 2048)   8192        conv5_block1_0_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_3_bn (BatchNormali (None, 5, 5, 2048)   8192        conv5_block1_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block1_add (Add)          (None, 5, 5, 2048)   0           conv5_block1_0_bn[0][0]          
                                                                     conv5_block1_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block1_out (Activation)   (None, 5, 5, 2048)   0           conv5_block1_add[0][0]           
    __________________________________________________________________________________________________
    conv5_block2_1_conv (Conv2D)    (None, 5, 5, 512)    1049088     conv5_block1_out[0][0]           
    __________________________________________________________________________________________________
    conv5_block2_1_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block2_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block2_1_relu (Activation (None, 5, 5, 512)    0           conv5_block2_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block2_2_conv (Conv2D)    (None, 5, 5, 512)    2359808     conv5_block2_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block2_2_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block2_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block2_2_relu (Activation (None, 5, 5, 512)    0           conv5_block2_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block2_3_conv (Conv2D)    (None, 5, 5, 2048)   1050624     conv5_block2_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block2_3_bn (BatchNormali (None, 5, 5, 2048)   8192        conv5_block2_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block2_add (Add)          (None, 5, 5, 2048)   0           conv5_block1_out[0][0]           
                                                                     conv5_block2_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block2_out (Activation)   (None, 5, 5, 2048)   0           conv5_block2_add[0][0]           
    __________________________________________________________________________________________________
    conv5_block3_1_conv (Conv2D)    (None, 5, 5, 512)    1049088     conv5_block2_out[0][0]           
    __________________________________________________________________________________________________
    conv5_block3_1_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block3_1_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block3_1_relu (Activation (None, 5, 5, 512)    0           conv5_block3_1_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block3_2_conv (Conv2D)    (None, 5, 5, 512)    2359808     conv5_block3_1_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block3_2_bn (BatchNormali (None, 5, 5, 512)    2048        conv5_block3_2_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block3_2_relu (Activation (None, 5, 5, 512)    0           conv5_block3_2_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block3_3_conv (Conv2D)    (None, 5, 5, 2048)   1050624     conv5_block3_2_relu[0][0]        
    __________________________________________________________________________________________________
    conv5_block3_3_bn (BatchNormali (None, 5, 5, 2048)   8192        conv5_block3_3_conv[0][0]        
    __________________________________________________________________________________________________
    conv5_block3_add (Add)          (None, 5, 5, 2048)   0           conv5_block2_out[0][0]           
                                                                     conv5_block3_3_bn[0][0]          
    __________________________________________________________________________________________________
    conv5_block3_out (Activation)   (None, 5, 5, 2048)   0           conv5_block3_add[0][0]           
    ==================================================================================================
    Total params: 58,370,944
    Trainable params: 0
    Non-trainable params: 58,370,944
    __________________________________________________________________________________________________
    


```python
additional_model = models.Sequential()
additional_model.add(base_model)
additional_model.add(layers.Flatten())
additional_model.add(layers.Dense(4096, activation='relu'))
additional_model.add(layers.Dense(2048, activation='relu'))
additional_model.add(layers.Dense(1024, activation='relu'))
additional_model.add(layers.Dense(1, activation='sigmoid'))
 
additional_model.summary()
```

    Model: "sequential_1"
    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    resnet152 (Model)            (None, 5, 5, 2048)        58370944  
    _________________________________________________________________
    flatten_1 (Flatten)          (None, 51200)             0         
    _________________________________________________________________
    dense (Dense)                (None, 4096)              209719296 
    _________________________________________________________________
    dense_1 (Dense)              (None, 2048)              8390656   
    _________________________________________________________________
    dense_2 (Dense)              (None, 1024)              2098176   
    _________________________________________________________________
    dense_3 (Dense)              (None, 1)                 1025      
    =================================================================
    Total params: 278,580,097
    Trainable params: 220,209,153
    Non-trainable params: 58,370,944
    _________________________________________________________________
    


```python
additional_model.compile(loss="binary_crossentropy", optimizer="nadam",metrics=['acc'])
```

<h1>데이터 부풀리기


```python
# from tensorflow.keras.preprocessing.image import ImageDataGenerator

# datagen = ImageDataGenerator(
#         rotation_range=40,
#         width_shift_range=0.2,
#         height_shift_range=0.2,
#         shear_range=0.2,
#         zoom_range=0.2,
#         horizontal_flip=True,
#         fill_mode='nearest')
# next_1_pix = [os.path.join(train_1_dir, fname) 
#                 for fname in train_1_fnames]
# for j in next_1_pix:
#     img = load_img(j)
#     x = img_to_array(img)
#     x = x.reshape((1,) + x.shape)
    
#     i = 0
#     for batch in datagen.flow(x, batch_size=1,
#                               save_to_dir='./input/dataset1/변형연갈탄'):
#         i += 1
#         if i > 20:
#             break  

```


```python
# from tensorflow.keras.preprocessing.image import ImageDataGenerator

# datagen = ImageDataGenerator(
#         rotation_range=40,
#         width_shift_range=0.2,
#         height_shift_range=0.2,
#         shear_range=0.2,
#         zoom_range=0.2,
#         horizontal_flip=True,
#         fill_mode='nearest')
# next_2_pix = [os.path.join(train_2_dir, fname) 
#                 for fname in train_2_fnames]
# for j in next_2_pix:
#     img = load_img(j)
#     x = img_to_array(img)
#     x = x.reshape((1,) + x.shape)
    
#     i = 0
#     for batch in datagen.flow(x, batch_size=1,
#                               save_to_dir='./input/dataset1/변형유연탄'):
#         i += 1
#         if i > 20:
#             break  

```


```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator
train_datagen = ImageDataGenerator(
        rescale=1./255,
        shear_range=0.2,
        zoom_range=0.2,
        horizontal_flip=True)


train_generator = train_datagen.flow_from_directory(
        train_dir,  
        target_size=(150, 150),  
        batch_size=32,
        
        class_mode='binary')

val_datagen = ImageDataGenerator(rescale=1./255)

validation_generator = val_datagen.flow_from_directory(
        validation_dir,
        target_size=(150, 150),
        batch_size=32,
        class_mode='binary')
```

    Found 2791 images belonging to 2 classes.
    Found 20 images belonging to 2 classes.
    


```python
history=additional_model.fit(train_generator,
epochs = 30,
validation_data = validation_generator
)
```

    Epoch 1/30
    88/88 [==============================] - 335s 4s/step - loss: 1.4045 - acc: 0.7571 - val_loss: 0.8275 - val_acc: 0.7000
    Epoch 2/30
    88/88 [==============================] - 334s 4s/step - loss: 0.3027 - acc: 0.8549 - val_loss: 0.5922 - val_acc: 0.7500
    Epoch 3/30
    88/88 [==============================] - 343s 4s/step - loss: 0.4192 - acc: 0.8484 - val_loss: 0.9746 - val_acc: 0.3000
    Epoch 4/30
    88/88 [==============================] - 344s 4s/step - loss: 0.3245 - acc: 0.8441 - val_loss: 0.4340 - val_acc: 0.7000
    Epoch 5/30
    88/88 [==============================] - 337s 4s/step - loss: 0.2164 - acc: 0.9119 - val_loss: 0.3611 - val_acc: 0.8000
    Epoch 6/30
    88/88 [==============================] - 339s 4s/step - loss: 0.1886 - acc: 0.9251 - val_loss: 0.3291 - val_acc: 0.8000
    Epoch 7/30
    88/88 [==============================] - 354s 4s/step - loss: 0.2016 - acc: 0.9165 - val_loss: 0.2987 - val_acc: 0.8500
    Epoch 8/30
    88/88 [==============================] - 350s 4s/step - loss: 0.2463 - acc: 0.8879 - val_loss: 0.2994 - val_acc: 0.9000
    Epoch 9/30
    88/88 [==============================] - 350s 4s/step - loss: 0.2148 - acc: 0.9058 - val_loss: 0.2370 - val_acc: 0.9000
    Epoch 10/30
    88/88 [==============================] - 347s 4s/step - loss: 0.1691 - acc: 0.9326 - val_loss: 0.2303 - val_acc: 0.8500
    Epoch 11/30
    88/88 [==============================] - 343s 4s/step - loss: 0.1438 - acc: 0.9420 - val_loss: 0.2222 - val_acc: 0.9000
    Epoch 12/30
    88/88 [==============================] - 338s 4s/step - loss: 0.3013 - acc: 0.9291 - val_loss: 1.4458 - val_acc: 0.7000
    Epoch 13/30
    88/88 [==============================] - 347s 4s/step - loss: 0.3577 - acc: 0.8373 - val_loss: 0.3400 - val_acc: 0.7000
    Epoch 14/30
    88/88 [==============================] - 334s 4s/step - loss: 0.2374 - acc: 0.8886 - val_loss: 0.2683 - val_acc: 0.9000
    Epoch 15/30
    88/88 [==============================] - 343s 4s/step - loss: 0.2039 - acc: 0.9180 - val_loss: 0.2304 - val_acc: 0.9500
    Epoch 16/30
    88/88 [==============================] - 333s 4s/step - loss: 0.1710 - acc: 0.9359 - val_loss: 0.1998 - val_acc: 0.9500
    Epoch 17/30
    88/88 [==============================] - 331s 4s/step - loss: 0.1574 - acc: 0.9405 - val_loss: 0.2246 - val_acc: 0.9000
    Epoch 18/30
    88/88 [==============================] - 333s 4s/step - loss: 0.1508 - acc: 0.9420 - val_loss: 0.1848 - val_acc: 0.9000
    Epoch 19/30
    88/88 [==============================] - 346s 4s/step - loss: 0.1355 - acc: 0.9477 - val_loss: 0.1470 - val_acc: 0.9500
    Epoch 20/30
    88/88 [==============================] - 338s 4s/step - loss: 0.1339 - acc: 0.9552 - val_loss: 0.1543 - val_acc: 0.9500
    Epoch 21/30
    88/88 [==============================] - 334s 4s/step - loss: 0.0982 - acc: 0.9617 - val_loss: 0.3639 - val_acc: 0.8500
    Epoch 22/30
    88/88 [==============================] - 338s 4s/step - loss: 0.1160 - acc: 0.9563 - val_loss: 0.2184 - val_acc: 0.9000
    Epoch 23/30
    88/88 [==============================] - 337s 4s/step - loss: 0.0955 - acc: 0.9609 - val_loss: 0.1684 - val_acc: 0.9500
    Epoch 24/30
    88/88 [==============================] - 337s 4s/step - loss: 0.0988 - acc: 0.9606 - val_loss: 0.1732 - val_acc: 0.9500
    Epoch 25/30
    88/88 [==============================] - 340s 4s/step - loss: 0.0813 - acc: 0.9695 - val_loss: 0.1626 - val_acc: 0.9500
    Epoch 26/30
    88/88 [==============================] - 337s 4s/step - loss: 0.0886 - acc: 0.9692 - val_loss: 0.2041 - val_acc: 0.8500
    Epoch 27/30
    88/88 [==============================] - 341s 4s/step - loss: 0.0782 - acc: 0.9692 - val_loss: 0.1679 - val_acc: 0.9500
    Epoch 28/30
    88/88 [==============================] - 334s 4s/step - loss: 0.0942 - acc: 0.9617 - val_loss: 0.1683 - val_acc: 0.9500
    Epoch 29/30
    88/88 [==============================] - 336s 4s/step - loss: 0.0930 - acc: 0.9638 - val_loss: 0.1860 - val_acc: 0.9500
    Epoch 30/30
    88/88 [==============================] - 339s 4s/step - loss: 0.0717 - acc: 0.9692 - val_loss: 0.1761 - val_acc: 0.9500
    


```python
%matplotlib inline

import matplotlib.image  as mpimg
import matplotlib.pyplot as plt


acc=history.history['acc']
val_acc=history.history['val_acc']
loss=history.history['loss']
val_loss=history.history['val_loss']

epochs=range(len(acc)) 
plt.plot(epochs, acc, 'r')
plt.plot(epochs, val_acc, 'b')
plt.figure()


plt.plot(epochs, loss, 'r')
plt.plot(epochs, val_loss, 'b')
plt.figure()


```




    <Figure size 432x288 with 0 Axes>




    
![coal_classification_transferlearning](https://raw.githubusercontent.com/junha-lee/junha-lee.github.io/main/assets/images/coal_classification_transferlearning_files/coal_classification_transferlearning_14_1.png)
    



    
![coal_classification_transferlearning](https://raw.githubusercontent.com/junha-lee/junha-lee.github.io/main/assets/images/coal_classification_transferlearning_files/coal_classification_transferlearning_14_2.png)
    



    <Figure size 432x288 with 0 Axes>



```python

from keras.preprocessing.image import load_img
from keras.preprocessing.image import img_to_array
from keras.models import load_model


def load_image(filename):
	img = load_img(filename, target_size=(150,150))
	img = img_to_array(img)
	img = img.reshape(1,150,150, 3)
	img = img.astype('float32')
	return img

test_dir ='./input/dataset3/valid'
test_1_dir = os.path.join(test_dir, '연갈탄')
test_2_dir = os.path.join(test_dir, '유연탄')

test_1_fnames = os.listdir(test_1_dir)
test_2_fnames = os.listdir(test_2_dir)

test_1_pix = [os.path.join(test_1_dir, fname) 
                for fname in test_1_fnames]
test_2_pix = [os.path.join(test_2_dir, fname) 
                for fname in test_2_fnames]
p1=0

for j in test_1_pix:
    img = load_image(j)
    result = additional_model.predict(img)
    if(result[0]==0):
        p1=p1+1
p2=0
for j in test_2_pix:
    img = load_image(j)
    result = additional_model.predict(img)
    if(result[0]==1):
        p2=p2+1
```


```python
print(p1)
```

    0
    


```python
print(p2)
```

    7
    


```python

```
